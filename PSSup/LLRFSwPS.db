record(stringin, "$(P):$(D):SaveName") {
    field(VAL,  "$(P):$(D).sav")
    field(PINI, "YES")
    field(DESC, "Autosave destination file")
}

record(waveform, "$(P):$(D):ADC0-Mon") {
    field(PINI, "YES")
    field(DESC, "ADC0 Data")
    field(SCAN, "$(S=1) second")
    field(DTYP, "stream")
    field(INP,  "@ADC.proto getData(ADC0) $(PORT) $(A)")
    field(FTVL, "DOUBLE")
    field(NELM, "4")
}
record(calc, "$(P):$(D):ADC0-Mon_enbl") {
   field(CALC, "A#0")
   field(INPA, "$(P):$(D):ADC0-Mon.STAT CP")
   field(INPB, "$(P):$(D):ADC0-Mon CP")
}

record(waveform, "$(P):$(D):ADC1-Mon") {
    field(PINI, "YES")
    field(DESC, "ADC1 Data")
    field(SCAN, "$(S=1) second")
    field(DTYP, "stream")
    field(INP,  "@ADC.proto getData(ADC1) $(PORT) $(A)")
    field(FTVL, "DOUBLE")
    field(NELM, "4")
}
record(calc, "$(P):$(D):ADC1-Mon_enbl") {
   field(CALC, "A#0")
   field(INPA, "$(P):$(D):ADC1-Mon.STAT CP")
   field(INPB, "$(P):$(D):ADC1-Mon CP")
}

record(calc, "$(P):$(D):VoltPos5V-Mon") {
    field(CALC, "(5.*A/4095.)*(1.5)")
    field(INPA, "$(P):$(D):ADC0-Mon.VAL[0] CP MSS")
    field(EGU, "V")
    field(DESC, "Tensão de saída da fonte de 5 Volts")
    field(MDEL, "0.001")
    field(DISV, "1")
    field(DISS, "INVALID")
    field(PREC, "4")
    field(SDIS, "$(P):$(D):ADC0-Mon_enbl")
}

record(calc, "$(P):$(D):VoltPos24V-Mon") {
    field(CALC, "(5.*A/4095.)*(5.99)")
    field(INPA, "$(P):$(D):ADC0-Mon.VAL[1] CP MSS")
    field(EGU, "V")
    field(DESC, "Tensão de saída da fonte de 24 Volts")
    field(MDEL, "0.001")
    field(DISV, "1")
    field(DISS, "INVALID")
    field(PREC, "4")
    field(SDIS, "$(P):$(D):ADC0-Mon_enbl")
}

record(calc, "$(P):$(D):VoltPos3V3-Mon") {
    field(CALC, "(5.*A/4095.)*(1)")
    field(INPA, "$(P):$(D):ADC0-Mon.VAL[2] CP MSS")
    field(EGU, "V")
    field(DESC, "Tensão de saída da fonte de 3.3 Volts")
    field(MDEL, "0.001")
    field(DISV, "1")
    field(DISS, "INVALID")
    field(PREC, "4")
    field(SDIS, "$(P):$(D):ADC0-Mon_enbl")
}

record(calc,"$(P):$(D):CurrentPos5V-Mon_raw") {
    field(CALC, "(5.*A/4095.)*(1)")
    field(INPA, "$(P):$(D):ADC1-Mon.VAL[0] CP MSS")
    field(DISV, "1")
    field(DISS, "INVALID")
    field(SDIS, "$(P):$(D):ADC1-Mon_enbl")
    field(PREC, "4")
}
# ((ADC1[0] - 0.5) / 0.4)
record(calc, "$(P):$(D):CurrentPos5V-Mon_") {
    field(CALC, "((A - 0.5)/0.4)")
    field(INPA, "$(P):$(D):CurrentPos5V-Mon_raw CP MSS")
    field(PREC, "4")
    field(MDEL, "0.001")
    field(EGU,  "A")
    field(DISV, "1")
    field(DISS, "INVALID")
    field(SDIS, "$(P):$(D):ADC1-Mon_enbl")
}
record(calc, "$(P):$(D):CurrentPos5V-Mon") {
    field(CALC, "A<0?0:A")
    field(INPA, "$(P):$(D):CurrentPos5V-Mon CP MSS")
    field(PREC, "4")
    field(EGU,  "A")
}

record(calc,"$(P):$(D):CurrentPos24V-Mon_raw") {
    field(CALC, "(5.*A/4095.)*(1)")
    field(INPA, "$(P):$(D):ADC1-Mon.VAL[1] CP MSS")
    field(DISV, "1")
    field(DISS, "INVALID")
    field(SDIS, "$(P):$(D):ADC1-Mon_enbl")
    field(PREC, "4")
}
# ((ADC1[1] - 0.5) / 0.4)
record(calc, "$(P):$(D):CurrentPos24V-Mon_") {
    field(CALC, "((A - 0.5)/0.4)")
    field(INPA, "$(P):$(D):CurrentPos24V-Mon_raw CP MSS")
    field(PREC, "4")
    field(MDEL, "0.001")
    field(EGU,  "A")
    field(DISV, "1")
    field(DISS, "INVALID")
    field(SDIS, "$(P):$(D):ADC1-Mon_enbl")
}
record(calc, "$(P):$(D):CurrentPos24V-Mon") {
    field(CALC, "A<0?0:A")
    field(INPA, "$(P):$(D):CurrentPos24V-Mon_ CP MSS")
    field(PREC, "4")
    field(EGU,  "A")
}

record(calc,"$(P):$(D):CurrentPos3V3-Mon_raw") {
    field(CALC, "(5.*A/4095.)*(1)")
    field(INPA, "$(P):$(D):ADC1-Mon.VAL[2] CP MSS")
    field(DISV, "1")
    field(DISS, "INVALID")
    field(SDIS, "$(P):$(D):ADC1-Mon_enbl")
    field(PREC, "4")
}
# ((ADC1[2] - 0.5) / 0.4)
record(calc, "$(P):$(D):CurrentPos3V3-Mon_") {
    field(CALC, "((A - 0.5)/0.4)")
    field(INPA, "$(P):$(D):CurrentPos3V3-Mon_raw CP MSS")
    field(PREC, "4")
    field(MDEL, "0.001")
    field(EGU,  "A")
    field(DISV, "1")
    field(DISS, "INVALID")
    field(SDIS, "$(P):$(D):ADC1-Mon_enbl")
}
record(calc, "$(P):$(D):CurrentPos3V3-Mon") {
    field(CALC, "A<0?0:A")
    field(INPA, "$(P):$(D):CurrentPos3V3-Mon_ CP MSS")
    field(PREC, "4")
    field(EGU,  "A")
}
